<html>
<head>
    <title>Test_cm.event.EventDispatcher.html</title>
    <script type="text/javascript" src="../coremind.js"></script>
</head>
<body>
    <script type="text/javascript">
    cm.Class.load("cm.event.EventDispatcher",
    function main()
    {
        var _a = {
            func1:function(e, arg0)
            {
                cm.log.d("TEST[callback dump]");
                cm.log.d(this.prop);//object _a
                cm.log.d("method name is func1");
                cm.log.d("arguments ", arg0);
                cm.log.d("TEST[event object dump]");
                cm.log.d(e.target.tag);//dispatcher object
                cm.log.d(e.type);//event type
            },
            func2:function(e, arg0, arg1)
            {
                cm.log.d("TEST[callback dump]");
                cm.log.d(this.prop);//object _a
                cm.log.d("method name is func2");
                cm.log.d("arguments ", arg0, arg1);
                cm.log.d("TEST[event object dump]");
                cm.log.d(e.target.tag);//dispatcher object
                cm.log.d(e.type);//event type
            },
            prop:"this is _a"
        };
        
        var _b = {
            func3:function(e, arg0, arg1, arg2)
            {
                cm.log.d("TEST[callback dump]");
                cm.log.d(this.prop);//object _b
                cm.log.d("method name is func3");
                cm.log.d("arguments ", arg0, arg1, arg2);
                cm.log.d("TEST[event object dump]");
                cm.log.d(e.target.tag);//dispatcher object
                cm.log.d(e.type);//event type
            },
            prop:"this is _b"
        };
        
        var _c = {
            func4:function(e, arg0, arg1, arg2, arg3)
            {
                cm.log.d("TEST[callback dump]");
                cm.log.d(this.prop);//object _c
                cm.log.d("method name is func4");
                cm.log.d("arguments ", arg0, arg1, arg2, arg3);
                cm.log.d("TEST[event object dump]");
                cm.log.d(e.target.tag);//dispatcher object
                cm.log.d(e.type);//event type
            },
            prop:"this is _c"
        };
        
        var obj = new cm.event.EventDispatcher();
        obj.tag = "eventDispatcherTAG";
        
        cm.log.d("TEST[add listener]");
        obj.addEventListener("TEST_EVENT", _a, _a.func1);
        obj.addEventListener("TEST_EVENT", _a, _a.func2);
        obj.addEventListener("TEST_EVENT", _b, _b.func3);
        
        cm.log.d("TEST[dispatch event]");
        obj.dispatchEvent("TEST_EVENT", "arg9", "arg8", "arg7");
        
        cm.log.d("TEST[has and remove listener]");
        //func1 only
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a, _a.func1));
        obj.removeEventListener("TEST_EVENT", _a, _a.func1);
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a, _a.func1));
        //and func2
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a, _a.func2));
        obj.removeEventListener("TEST_EVENT", _a, _a.func2);
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _a, _a.func2));
        //and func3
        cm.log.d(obj.hasEventListener("TEST_EVENT", _b));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _b, _b.func3));
        obj.removeEventListener("TEST_EVENT", _b, _b.func3);
        cm.log.d(obj.hasEventListener("TEST_EVENT", _b));
        cm.log.d(obj.hasEventListener("TEST_EVENT", _b, _b.func3));
        obj.dispatchEvent("TEST_EVENT", "arg9", "arg8", "arg7");
        
        cm.log.d("TEST[add listener (+priority)]");
        obj.addEventListener("TEST_EVENT", _a, _a.func1, 8);//4
        obj.addEventListener("TEST_EVENT", _c, _c.func4, 100);//1
        obj.addEventListener("TEST_EVENT", _a, _a.func2, 9);//3
        obj.addEventListener("TEST_EVENT", _b, _b.func3, 10);//2
        obj.dispatchEvent("TEST_EVENT", "arg6", "arg5", "arg4", "arg3");
        
        cm.log.d("TEST[dump listener count]");
        cm.log.d(obj.getListenerCount());
        
        obj.destroy();
    });
    </script>
</body>
</html>