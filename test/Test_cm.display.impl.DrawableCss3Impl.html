<!DOCTYPE html>
<html>
<head>
    <link href="../html5reset-1.6.1.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="../coremind.js"></script>
    <style type="text/css">
    </style>
</head>
<body style="background-color: white" id="body">
    <div id="content">
    <div id="testX" style="width: 100px; height: 100px;";>X</div>
    <div id="testY" style="background-color: #00FF00; width: 20px; height: 100px;";>Y</div>
    <div id="testWidth" style="background-color: #FFFF00; width: 100px; height: 100px;";>WIDTH</div>
    <div id="testHieght" style="background-color: rgba(128, 256, 256, 128); background-image: url('./0.gif'); width: 100px; height: 100px;";>HEIGHT</div>
    <div id="testColor" style="background-color: #FF0000; width: 100px; height: 100px;";>BGCOLOR</div>
    <div id="testImage" style="background-color: #000; width: 100px; height: 100px;";>BGIMAGE</div>
    <div id="testGradient" style="background-color: #000; 100px; height: 100px; overflow: hidden";>BGGRADIENT</div>
    </div>
    <div id="P1" style="background-color: #0000FF; width: 100px; height: 100px;";>P1</div>
    <div id="P2" style="background-color: #00FFFF; width: 100px; height: 100px;";>P2</div>
    <div id="P3" style="background-color: #FFFF00; width: 100px; height: 100px;";>P3</div>
    <div id="P4" style="background-color: #FF00FF; width: 100px; height: 100px;";>P4</div>
    <div id="P5" style="background-color: #FF0000; width: 100px; height: 100px;";>P5</div>
    
    <script type="text/javascript">
    var _class = "cm.display.impl.DrawableCss3Impl";
    document.title = _class;
    cm.Class.load(
        "cm.motion.Easing",
        "cm.motion.Tweener",
        "cm.util.LinkedTask",
        "cm.display.abs.fill.Shadow",
        "cm.core.DisplayInterface",
        _class,
        function()
        {
            var ids = [
                "testX", "testY", "testWidth", "testHieght", "testColor", "testImage", "testGradient"];
            var methods = [
                "xRel", "yRel", "widthFix", "heightFix", "editBackgroundColor", "editBackgroundImage", "editBackgroundGradient"];
            var values = [50, 50, 175, 450, 0xFF808080, "./0.gif"];
            var _s1 = new cm.display.abs.fill.Shadow(0, 0, 14, 10, 0x80FF0000);
            var _s2 = new cm.display.abs.fill.Shadow(0, 0, 14, 10, 0x8000FF00);
            var _sO = null;
            var _sQ = null;
            for(var i = 0, len = ids.length; i < len; i ++)
            {
                var obj = document.getElementById(ids[i]);
                cm.core.DisplayInterface.attach(obj);
                obj.cmDisplay.useCss3();
                //obj.cmDisplay.drawable.enabledAbsoluteStyle();
                obj.cmDisplay.position.xRel(100 * i);
                obj.cmDisplay.drawable.draw();
                //obj.cmDisplay.container.widthRel(100).heightRel(100);
                obj.cmDisplay.background.editColor().argbFix(0xFF808080);
                obj.cmDisplay.container.editShape().roundFix(5);
                switch (i)
                {
                    case 0:
                    case 1:
                        obj.cmDisplay.position[methods[i]](values[i]);
                        obj.cmDisplay.container.widthRel(90);
                        break;
                    case 3:
                        obj.cmDisplay.container[methods[i]](values[i]);
                        obj.cmDisplay.filters.add(_s1).add(_s2);
                        _sO = obj;
                        break;
                    case 4:
                        obj.cmDisplay.background.editColor().argbFix(0xFF000000 + 0xfF);
                        break;
                    case 5:
                        obj.cmDisplay.background.editImage()
                            .setSource(values[i])
                            .editAlign().applyCenterH().applyCenterV();
                        break;
                    case 6:
                        obj.cmDisplay.container.editShape()
                            .roundFix(40)
                            .bottomLeftFix(15, 15);
                        obj.cmDisplay.border
                            .weightFix(5)
                            .setStyle(cm.display.abs.Border.SOLID)
                            .editColor().argbFix(0x80FF0000);
                        obj.cmDisplay.background.editGradient()
                            .pushColors(new cm.display.abs.fill.Color(0xFF00FF00), 50)
                            .pushColors(new cm.display.abs.fill.Color(0xFFFFFFFF), 1)
                            .pushColors(new cm.display.abs.fill.Color(0xFF00FF00), 50)
                            .editBeginColor().argbFix(0xFF000000);
                        _sQ = obj;
                        break;
                    default:
                        obj.cmDisplay.container[methods[i]](values[i]);
                        break;
                }
                obj.cmDisplay.drawable.draw();
            }
            cm.log.dump(_sO.style);
            
            var u = new cm.util.Updater();
            u.update = function() {
                _sQ.cmDisplay.drawable.draw();//test
            };
            u.start(1000000, 0);
            
            var a = new cm.motion.Tweener().target(_sQ.cmDisplay.position);
            var b = new cm.motion.Tweener().target(_sQ.cmDisplay.container);
            var _lt = new cm.util.LinkedTask(false);
            _lt
                .push(b, "reverse", false)
                /*
                .push(a, "reverse", false)
                .push(a, "prop", "x")
                .push(a, "toFixed", 50)
                .push(a, "easing", cm.motion.Easing.BounceIn)
                .push(a, "start", 1000, 1)
                */
                .push(b, "prop", "width")
                .push(b, "toRelative", 100)
                .push(b, "easing", cm.motion.Easing.BounceIn)
                .push(b, "start", 1000, 1)
                //.push(a, "reverse", true)
                .push(b, "reverse", true)
                .invokeCurrentTask();
                
                
                /*
            var t = new cm.motion.Tweener(_sO);
            var _lt = new cm.util.LinkedTask(false);
            _lt
                .push(t, "reverse", false)
                .push(t, "start", _sO.cmDisplay.position.tween("x", 50), 500, cm.motion.Easing.Linear)
                .push(t, "start", _sO.cmDisplay.position.tween("y", 50), 500, cm.motion.Easing.QuartIn)
                .push(t, "start", _sO.cmDisplay.position.tween("y", 50), 500, cm.motion.Easing.ExpoIn)
                .push(t, "start", _sO.cmDisplay.position.tween("x", 50), 500, cm.motion.Easing.BounceIn)
                .push(t, "gotoAndPlay", 300)
                .push(t, "reverse", true)
                .invokeCurrentTask();
                */
            var _s3 = new cm.display.abs.fill.Shadow(0, 0, 30, 0, 0x80000000, true);
            setTimeout(function(){
                _sO.cmDisplay.filters.add(_s3);
                _s1.editOffsetPosition().x = 100;
                _s1.editColor().argbFix(0x800000FF);
                _s2.editOffsetPosition().x = -100;
                _s2.editColor().argbFix(0x8000FF00);
                _sO.cmDisplay.drawable.draw();
                setTimeout(function(){
                    _s2.editOffsetPosition().y = -100;
                    _s2.editColor().argbFix(0x80FF0000);
                    _s3.enabledInset();
                    _sO.cmDisplay.filters.remove(_s1);
                    _sO.cmDisplay.drawable.draw();
                    setTimeout(function(){
                        _sO.cmDisplay.filters.remove(_s3);
                        _sO.cmDisplay.drawable.draw();
                    }, 1000);
                }, 1000);
            }, 1000);
        });
    </script>
<script>if (location.hostname == "127.0.0.1") { document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=2"></' + 'script>') }</script>
</body>
</html>